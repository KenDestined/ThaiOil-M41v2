List<CTRIntegrationMapping__mdt> mAllMappingList = [SELECT Id, BusinessUnit__c, IntegrationType__c, JsonMapping__c, RecordType__c, ViewName__c,SupportIntegrationType__c FROM CTRIntegrationMapping__mdt];

Id mItemId = 'a3c1m000000MROkAAO';
Set<Id> mItemSetId = new Set<Id>();
mItemSetId.add(mItemId);
List<CTRRequestFormItem__c> mRequestItemList = CTRCommitteeSendToSap.geRequestItemForSendToSAP(mItemSetId);
CTRRequestFormItem__c mRequestItem = mRequestItemList[0]; 

Set<Id> mHeaderSetId = new Set<Id>();
mHeaderSetId.add(mRequestItem.CTRRequestFormHeader__c);
List<CTRRequestFormHeader__c>mHeaderList = CTRCommitteeSendToSap.geRequestHeaderForSendToSAP(mHeaderSetId);
CTRRequestFormHeader__c mRequestHeader = mHeaderList[0];

    String jsonInput = '';
    CTRRequestItemIntegrationEditController.mapLv1 mEditData = new CTRRequestItemIntegrationEditController.mapLv1();
    mEditData = CTRRequestItemIntegrationEditController.SetupJsonForCTRDataModelv2(mAllMappingList, mRequestHeader,mRequestItem, 'Customer', 'TOP', 'gateway', 'Static', '' ,'',  true);
    jsonInput = JSON.serialize(mEditData);
    jsonInput = jsonInput.replace('null', '""');
    System.debug('Result:'+jsonInput);

String mHeaderObjectName = 'CTRRequestFormHeader__c';
List<CTRFieldEditLog__mdt> mCounterPartyFieldLogList = [SELECT Id, Source__c, FieldList__c, Object__c FROM CTRFieldEditLog__mdt WHERE Source__c = 'Counter party' AND Object__c =:mHeaderObjectName];
Map<String, String> mFieldListMap = new Map<String, String>();
mFieldListMap.put(mCounterPartyFieldLogList[0].Object__c, mCounterPartyFieldLogList[0].FieldList__c);
List<SObject> mHeaderFilteredList = new List<SObject>();
mHeaderFilteredList.add((SObject)mRequestHeader);
List<String> mHeaderFieldNameList = CTRRequestEditLogFieldController.getFieldListFromJson(mFieldListMap.get(mHeaderObjectName), mHeaderObjectName);
Map<Id, String> mCounterPartyJsonMapResult  = CTRRequestEditLogFieldController.SavePointValueRecordToJson(mHeaderFilteredList, mHeaderFieldNameList, mHeaderObjectName);
mRequestHeader.InternalEditField__c = mCounterPartyJsonMapResult.get(mRequestItem.CTRRequestFormHeader__c);

    String jsonInputSub = '';
    CTRRequestItemIntegrationEditController.mapLv1 mEditDataSub = new CTRRequestItemIntegrationEditController.mapLv1();
    mEditDataSub = CTRRequestItemIntegrationEditController.SetupJsonForCTRDataModelv2(mAllMappingList, mRequestHeader,mRequestItem, 'Supplier', 'TOP', 'gatewatsub', 'Dynamic', '', 'Extend',false);

    jsonInputSub = JSON.serialize(mEditDataSub);
    jsonInputSub = jsonInputSub.replace('null', '""');
    System.debug('Result2:'+jsonInputSub);



List<CTRIntegrationMapping__mdt> mAllMappingList = [SELECT Id, BusinessUnit__c, IntegrationType__c, JsonMapping__c, RecordType__c, ViewName__c,SupportIntegrationType__c FROM CTRIntegrationMapping__mdt];

Id mItemId = 'a3c1m000000MSGYAA4';
Set<Id> mItemSetId = new Set<Id>();
mItemSetId.add(mItemId);
List<CTRRequestFormItem__c> mRequestItemList = CTRsendToSAPController.getRequestItemForSendToSAP(mItemSetId);
CTRRequestFormItem__c mRequestItem = mRequestItemList[0]; 

Set<Id> mHeaderSetId = new Set<Id>();
mHeaderSetId.add(mRequestItem.CTRRequestFormHeader__c);
List<CTRRequestFormHeader__c>mHeaderList = CTRsendToSAPController.getRequestHeaderForSendToSAP(mHeaderSetId);
CTRRequestFormHeader__c mRequestHeader = mHeaderList[0];

CTRsendToSAPController.SubmitToSAP(mRequestHeader, mRequestItem, mRequestItem.Id, false);
